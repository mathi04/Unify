{% extends "base.html" %}
{% block title %}Catalogue des cours{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
  <h1>Catalogue des cours</h1>
  {% if current_user.is_authenticated and current_user.professor %}
    <a href="{{ url_for('courses.create_course') }}" class="btn">Créer un cours</a>
  {% endif %}
</div>

{% if courses %}
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: var(--spacing-md);">
    {% for course in courses %}
      <div class="card">
        <h3><a href="{{ url_for('courses.course_detail', course_id=course.id) }}">{{ course.name }}</a></h3>
        <p style="color: var(--color-accent); font-weight: 600;">{{ course.code }}</p>
        
        {% if course.description %}
          <p>{{ course.description[:100] }}{% if course.description|length > 100 %}...{% endif %}</p>
        {% endif %}
        
        {% if course.average_hours %}
        <div style="background: rgba(255, 255, 255, 0.03); padding: var(--spacing-xs); border-radius: var(--radius-sm); margin: var(--spacing-sm) 0;">
          <div>
            {% set difficulty = course.difficulty_rating %}
            {% if difficulty == 1 %}Très facile
            {% elif difficulty == 2 %}Facile
            {% elif difficulty == 3 %}Moyen
            {% elif difficulty == 4 %}Difficile
            {% elif difficulty == 5 %}Très difficile
            {% endif %}
          </div>
          <div style="font-size: var(--font-size-sm);">
            ~{{ course.average_hours }}h/semaine - Note moy: {{ course.average_grade }}/20 - {{ course.feedback_count }} avis
          </div>
        </div>
        {% endif %}
        
        <div style="margin-top: var(--spacing-md); padding-top: var(--spacing-sm); border-top: 1px solid var(--glass-border);">
          <div style="font-size: var(--font-size-sm);">
            {{ course.professor.full_name }} - {{ course.credits }} crédits - {{ course.enrolled_count }} étudiants
          </div>
          
          {% if current_user.is_authenticated and current_user.student %}
            {% if course.id in enrolled_course_ids %}
              <span style="color: #4ade80;">Inscrit</span>
            {% else %}
              <a href="{{ url_for('courses.course_detail', course_id=course.id) }}" class="btn">Voir</a>
            {% endif %}
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>Aucun cours disponible pour le moment.</p>
{% endif %}
{% endblock %}
