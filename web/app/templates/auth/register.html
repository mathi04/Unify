{% extends "base.html" %}
{% block title %}Inscription{% endblock %}

{% block content %}
<h1>Créer un compte</h1>
<form method="post" id="registerForm">
  <label>Prénom</label>
  <input type="text" name="first_name" required>

  <label>Nom</label>
  <input type="text" name="last_name" required>

  <label>Nom d'utilisateur</label>
  <input type="text" name="username" required>

  <label>Email</label>
  <input type="email" name="email" required>

  <label>Mot de passe</label>
  <input type="password" name="password" required minlength="6">

  <label>Je suis un(e):</label>
  <div style="margin-bottom: var(--spacing-md);">
    <label style="display: inline-block; margin-right: var(--spacing-md); text-transform: none; cursor: pointer;">
      <input type="radio" name="role" value="student" required style="width: auto; margin-right: 0.5rem;" checked>
      Étudiant(e)
    </label>
    <label style="display: inline-block; text-transform: none; cursor: pointer;">
      <input type="radio" name="role" value="professor" required style="width: auto; margin-right: 0.5rem;">
      Professeur(e)
    </label>
  </div>

  <!-- Student-specific field -->
  <div id="studentFields" style="margin-bottom: var(--spacing-md);">
    <label>Matricule</label>
    <input type="text" name="matricule" id="matriculeInput" placeholder="Ex: STU001">
  </div>

  <!-- Professor-specific field -->
  <div id="professorFields" style="display: none; margin-bottom: var(--spacing-md);">
    <label>Département</label>
    <input type="text" name="department" id="departmentInput" placeholder="Ex: Computer Science">
  </div>

  <button type="submit">S'inscrire</button>

  <p style="margin-top: var(--spacing-md); text-align: center;">
    Déjà un compte? <a href="{{ url_for('auth.login') }}">Se connecter</a>
  </p>
</form>

<script>
  // Toggle fields based on role selection
  const radioButtons = document.querySelectorAll('input[name="role"]');
  const studentFields = document.getElementById('studentFields');
  const professorFields = document.getElementById('professorFields');
  const matriculeInput = document.getElementById('matriculeInput');
  const departmentInput = document.getElementById('departmentInput');

  function updateFields() {
    const selectedRole = document.querySelector('input[name="role"]:checked').value;

    if (selectedRole === 'student') {
      studentFields.style.display = 'block';
      professorFields.style.display = 'none';
      matriculeInput.required = true;
      departmentInput.required = false;
    } else {
      studentFields.style.display = 'none';
      professorFields.style.display = 'block';
      matriculeInput.required = false;
      departmentInput.required = true;
    }
  }

  radioButtons.forEach(radio => {
    radio.addEventListener('change', updateFields);
  });

  // Initialize on page load
  updateFields();
</script>
{% endblock %}